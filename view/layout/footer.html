{{ define "layout/footer.html" }}

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    function editTodo(todoId) {
        console.log(todoId);
    }

    function deleteTodo(todoId) {
        const swalWithBootstrapButtons = Swal.mixin({
            customClass: {
                confirmButton: 'btn btn-success',
                cancelButton: 'btn btn-danger'
            },
            buttonsStyling: false
        })

        if (todoId) {
            swalWithBootstrapButtons.fire({
                title: 'ต้องการลบรายการ ' + todoId + ' หรือไม่',
                text: "",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonText: 'ดำเนินการ',
                cancelButtonText: 'ยกเลิก',
                reverseButtons: true
            }).then((result) => {
                if (result.isConfirmed) {
                    $.ajax({
                        type: "delete",
                        url: "/todo/delete/" + todoId,
                        dataType: "json",
                        success: function(response) {
                            let todoId = response.todoId;
                            if (todoId) {
                                swalWithBootstrapButtons.fire(
                                    'ลบข้อมูลสำเร็จ!',
                                    '',
                                    'success'
                                )
                            }
                            //console.log(response);
                        }
                    });

                } else if (result.dismiss === Swal.DismissReason.cancel) {
                    swalWithBootstrapButtons.fire(
                        'ยกเลิกดำเนินการ',
                        '',
                        'error'
                    )
                }
            })
        }
        console.log(todoId);
    }
    $(function() {
        const url = new URL(window.location.href);
        const msgAction = url.searchParams.get("msg");
        if (msgAction == "created") {
            Swal.fire('เพิ่มข้อมูล task สำเร็จ', '', 'success');
        }

        $("#table-todo").DataTable({
            scrollY: 500,
        });
        $("#btn-create-todo").click(function(e) {
            e.preventDefault();
            let title = $("#title").val();
            let description = $("#description").val();
            if (title == "") {
                Swal.fire('กรอกหัวข้อ', '', 'warning');
                $("#title").focus();
                return;
            }

            if (description == "") {
                Swal.fire('กรอกรายละเอียด', '', 'warning');
                $("#description").focus();
                return;
            }

            $("#submit-form-todo").submit();
        });
    });
</script>

</body>

</html>

{{ end }}